<!DOCTYPE html>

<head>

<script>
function closeButton() {
  window.close()
}
</script>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<!-- font -->
<link href="https://fonts.googleapis.com/css?family=Nunito+Sans" rel="stylesheet">
<link rel="stylesheet" href="../static/style.css">
<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<!-- chart.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.bundle.min.js"></script>

</head>
<body>
  <h1>Take a Break</h1>
  <p>Time remaining: <span id="timeout"></span></p>
  <table>
    <tr>
      <td>
        <img src="../static/handstretch1.gif">
      </td>
      <td>
        <canvas id="timeChart" width="200" height:"200"></canvas>
      </td>
    </tr>
  </table>
  <button disabled id="hide" onClick="closeButton()" class="btn btn-warning">Hide this screen, I don't want to take a break!</button>
</body>

<script>
// Chart
var ctx = document.querySelector('#timeChart')
var timeChart = new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: [
        'Active',
        'Idle'
      ],
      datasets: [
        {
          data: [9, 3],
          backgroundColor: [
            "#FF6384",
            "#36A2EB"
          ],
          hoverBackgroundColor: [
            "#FF6384",
            "#36A2EB"
          ]
        }]
      },
      options: {
        responsive: true
      }
    })

// setup for other elements
var rest = parseInt(location.hash.substr(1)) || 60 // reads argument in main.jsâ€”t--number of seconds break
var start = Date.now()
var hideBtn = document.querySelector('#hide')
var pTag = document.querySelector('#timeout')

// enables button after 5 seconds
setTimeout(function() {
  hideBtn.disabled = false
}, 5000)

// countdown
setInterval(function() {
  var now = Date.now() // time calculations
  var dur = now - start
  var remain = rest - Math.floor(dur/1000)
  pTag.textContent = remain

  if (remain <= 0) {
    closeButton()
  }
}, 1000)  // runs every second

</script>
